<Window x:Class="FileEncrypter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="FileEncrypter"
        Width="900" Height="700"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource SurfaceBrush}"
        AllowDrop="True"
        DragEnter="Window_DragEnter"
        DragOver="Window_DragOver"
        DragLeave="Window_DragLeave"
        Drop="Window_Drop">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Grid.Column="0" Style="{StaticResource SidebarPanel}">
            <StackPanel>
                <!-- Logo/Header -->
                <Border Background="{StaticResource AccentBrush}" Padding="16,20">
                    <TextBlock Text="🔐 FileEncrypter" 
                               FontSize="18" 
                               FontWeight="Bold" 
                               Foreground="White" 
                               HorizontalAlignment="Center"/>
                </Border>

                <!-- Navigation Buttons -->
                <StackPanel Margin="0,16,0,0">
                    <Button x:Name="EncryptNavButton"
                            Content="🔒 Encriptar"
                            Style="{StaticResource SidebarButtonActive}"
                            Click="EncryptNav_Click"/>
                    <Button x:Name="DecryptNavButton"
                            Content="🔓 Desencriptar"
                            Style="{StaticResource SidebarButton}"
                            Click="DecryptNav_Click"/>
                </StackPanel>

                <!-- Progress Section (Global) -->
                <StackPanel x:Name="ProgressSection" Visibility="Collapsed" Margin="16,24,16,0">
                    <TextBlock 
                        Text="📊 Progreso" 
                        FontSize="12"
                        FontWeight="SemiBold"
                        Foreground="{StaticResource OnSurfaceBrush}"
                        Margin="0,0,0,8"/>
                    <ProgressBar 
                        x:Name="ProgressBar" 
                        Style="{StaticResource ModernProgressBar}"/>
                    <Button 
                        x:Name="CancelButton" 
                        Content="❌ Cancelar" 
                        Style="{StaticResource SmallButton}"
                        Click="CancelButton_Click" 
                        IsEnabled="False"
                        Margin="0,8,0,0"
                        HorizontalAlignment="Stretch"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Main Content Area -->
        <ScrollViewer Grid.Column="1" Style="{StaticResource ContentPanel}">
            <StackPanel MaxWidth="600">

                <!-- Encrypt Section -->
                <StackPanel x:Name="EncryptSection" Visibility="Visible">
                    <TextBlock Text="🔒 Encriptar Archivos" Style="{StaticResource SectionHeader}"/>

                    <!-- Password Card for Encryption -->
                    <Border Style="{StaticResource Card}">
                        <StackPanel Style="{StaticResource InputContainer}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock 
                                    Grid.Column="0"
                                    Text="🔑 Contraseña de Encriptación" 
                                    Style="{StaticResource SectionTitle}"/>
                                
                                <Button 
                                    Grid.Column="1"
                                    x:Name="ToggleGeneratorButton"
                                    Content="🎲 Generar"
                                    Style="{StaticResource SmallButton}"
                                    Click="ToggleGenerator_Click"
                                    VerticalAlignment="Center"
                                    Margin="0"/>
                            </Grid>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <PasswordBox 
                                    Grid.Column="0"
                                    x:Name="EncryptPasswordInput" 
                                    Style="{StaticResource ModernPasswordBox}"
                                    ToolTip="Ingrese una contraseña segura"
                                    PasswordChanged="EncryptPasswordInput_PasswordChanged"/>
                                
                                <Button 
                                    Grid.Column="1"
                                    x:Name="ShowEncryptPasswordButton"
                                    Content="👁️"
                                    Style="{StaticResource SmallButton}"
                                    Click="ShowEncryptPassword_Click"
                                    VerticalAlignment="Center"
                                    Margin="8,0,0,0"/>
                            </Grid>

                            <!-- Password Strength Indicator -->
                            <StackPanel x:Name="EncryptStrengthIndicator" Margin="0,8,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <ProgressBar 
                                        x:Name="EncryptStrengthBar"
                                        Grid.Column="0"
                                        Height="4"
                                        Background="#FF374151"
                                        BorderThickness="0"
                                        Value="0"
                                        Maximum="100"/>
                                    
                                    <TextBlock 
                                        x:Name="EncryptStrengthText"
                                        Grid.Column="1"
                                        Text="Débil"
                                        FontSize="12"
                                        Margin="8,0,0,0"
                                        VerticalAlignment="Center"/>
                                </Grid>
                            </StackPanel>

                            <!-- Password Generator -->
                            <Border x:Name="PasswordGenerator" 
                                    Style="{StaticResource PasswordGeneratorCard}" 
                                    Visibility="Collapsed">
                                <StackPanel>
                                    <TextBlock 
                                        Text="⚙️ Configuración del Generador" 
                                        FontSize="14" 
                                        FontWeight="SemiBold" 
                                        Foreground="{StaticResource OnSurfaceBrush}"
                                        Margin="0,0,0,12"/>

                                    <!-- Length Control -->
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock 
                                            Grid.Column="0"
                                            Text="Longitud:" 
                                            Foreground="{StaticResource OnSurfaceBrush}"
                                            VerticalAlignment="Center"
                                            Margin="0,0,12,0"/>
                                        
                                        <Slider 
                                            Grid.Column="1"
                                            x:Name="LengthSlider"
                                            Style="{StaticResource ModernSlider}"
                                            Minimum="4"
                                            Maximum="32"
                                            Value="12"
                                            IsSnapToTickEnabled="True"
                                            TickFrequency="1"
                                            ValueChanged="LengthSlider_ValueChanged"/>
                                        
                                        <TextBlock 
                                            Grid.Column="2"
                                            x:Name="LengthValue"
                                            Text="12"
                                            Foreground="{StaticResource AccentBrush}"
                                            FontWeight="SemiBold"
                                            VerticalAlignment="Center"
                                            Margin="12,0,0,0"/>
                                    </Grid>

                                    <!-- Character Types -->
                                    <TextBlock 
                                        Text="Tipos de caracteres:"
                                        Foreground="{StaticResource OnSurfaceBrush}"
                                        FontSize="13"
                                        Margin="0,0,0,8"/>

                                    <StackPanel>
                                        <CheckBox 
                                            x:Name="IncludeUppercase"
                                            Content="Mayúsculas (A-Z)"
                                            Style="{StaticResource ModernCheckBox}"
                                            IsChecked="True"
                                            Checked="CharacterType_Changed"
                                            Unchecked="CharacterType_Changed"/>
                                        
                                        <CheckBox 
                                            x:Name="IncludeLowercase"
                                            Content="Minúsculas (a-z)"
                                            Style="{StaticResource ModernCheckBox}"
                                            IsChecked="True"
                                            Checked="CharacterType_Changed"
                                            Unchecked="CharacterType_Changed"/>
                                        
                                        <CheckBox 
                                            x:Name="IncludeNumbers"
                                            Content="Números (0-9)"
                                            Style="{StaticResource ModernCheckBox}"
                                            IsChecked="True"
                                            Checked="CharacterType_Changed"
                                            Unchecked="CharacterType_Changed"/>
                                        
                                        <CheckBox 
                                            x:Name="IncludeSpecial"
                                            Content="Caracteres especiales (!@#$%^&amp;*)"
                                            Style="{StaticResource ModernCheckBox}"
                                            IsChecked="True"
                                            Checked="CharacterType_Changed"
                                            Unchecked="CharacterType_Changed"/>
                                    </StackPanel>

                                    <!-- Generated Password Preview -->
                                    <Grid Margin="0,12,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox 
                                            Grid.Column="0"
                                            x:Name="GeneratedPasswordPreview"
                                            IsReadOnly="True"
                                            Background="#FF374151"
                                            Foreground="{StaticResource OnSurfaceBrush}"
                                            BorderBrush="#FF4A4A4A"
                                            BorderThickness="1"
                                            Padding="8"
                                            FontFamily="Consolas"
                                            FontSize="12"
                                            Text="Haz clic en 'Generar' para crear una contraseña"/>
                                        
                                        <Button 
                                            Grid.Column="1"
                                            Content="📋"
                                            Style="{StaticResource SmallButton}"
                                            Click="CopyPassword_Click"
                                            ToolTip="Copiar al portapapeles"
                                            Margin="8,0,0,0"/>
                                    </Grid>

                                    <!-- Generate and Apply Buttons -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <Button 
                                            Grid.Column="0"
                                            Content="🎲 Generar"
                                            Style="{StaticResource AccentButton}"
                                            Click="GeneratePassword_Click"
                                            Margin="0,0,6,0"/>
                                        
                                        <Button 
                                            Grid.Column="1"
                                            Content="✅ Usar esta"
                                            Style="{StaticResource AccentButton}"
                                            Click="UseGeneratedPassword_Click"
                                            Margin="6,0,0,0"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- Encrypt Drag & Drop Card -->
                    <Border Style="{StaticResource Card}">
                        <StackPanel>
                            <TextBlock 
                                Text="📂 Arrastrar Archivos para Encriptar" 
                                Style="{StaticResource SectionTitle}"/>
                            
                            <Grid x:Name="EncryptDropZone" Height="120" Margin="0,8,0,0">
                                <Rectangle 
                                    Stroke="{StaticResource AccentBrush}" 
                                    StrokeThickness="2" 
                                    StrokeDashArray="8,4" 
                                    RadiusX="12" 
                                    RadiusY="12"
                                    Fill="Transparent"/>
                                
                                <StackPanel 
                                    HorizontalAlignment="Center" 
                                    VerticalAlignment="Center">
                                    <TextBlock 
                                        Text="📁" 
                                        FontSize="32" 
                                        HorizontalAlignment="Center" 
                                        Foreground="{StaticResource AccentBrush}"
                                        Margin="0,0,0,8"/>
                                    <TextBlock 
                                        Text="Arrastra archivos aquí para encriptar" 
                                        FontSize="16" 
                                        FontWeight="SemiBold"
                                        HorizontalAlignment="Center" 
                                        Foreground="{StaticResource OnSurfaceBrush}"
                                        Margin="0,0,0,8"/>
                                    <TextBlock 
                                        Text="O haz clic en el botón de abajo" 
                                        FontSize="12" 
                                        HorizontalAlignment="Center" 
                                        Foreground="{StaticResource AccentBrush}" 
                                        Opacity="0.8"/>
                                </StackPanel>
                            </Grid>

                            <Button 
                                Content="📁 Seleccionar Archivo para Encriptar"
                                Style="{StaticResource AccentButton}"
                                Click="EncryptFile_Click"
                                HorizontalAlignment="Center"
                                Margin="0,16,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Decrypt Section -->
                <StackPanel x:Name="DecryptSection" Visibility="Collapsed">
                    <TextBlock Text="🔓 Desencriptar Archivos" Style="{StaticResource SectionHeader}"/>

                    <!-- Password Card for Decryption -->
                    <Border Style="{StaticResource Card}">
                        <StackPanel Style="{StaticResource InputContainer}">
                            <TextBlock 
                                Text="🔑 Método de Desencriptación" 
                                Style="{StaticResource SectionTitle}"/>
                            
                            <!-- Method Selection -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                <RadioButton 
                                    x:Name="UsePasswordRadio"
                                    Content="Usar Contraseña"
                                    IsChecked="True"
                                    Checked="DecryptionMethod_Changed"
                                    Foreground="{StaticResource OnSurfaceBrush}"
                                    FontSize="14"
                                    Margin="0,0,24,0"/>
                                <RadioButton 
                                    x:Name="UseRecoveryPhraseRadio"
                                    Content="Usar Frase de Recuperación"
                                    Checked="DecryptionMethod_Changed"
                                    Foreground="{StaticResource OnSurfaceBrush}"
                                    FontSize="14"/>
                            </StackPanel>

                            <!-- Password Input -->
                            <StackPanel x:Name="PasswordDecryptPanel">
                                <TextBlock 
                                    Text="Contraseña:" 
                                    FontSize="14"
                                    Foreground="{StaticResource OnSurfaceBrush}"
                                    Margin="0,0,0,8"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <PasswordBox 
                                        Grid.Column="0"
                                        x:Name="DecryptPasswordInput" 
                                        Style="{StaticResource ModernPasswordBox}"
                                        ToolTip="Ingrese la contraseña de desencriptación"/>
                                    
                                    <Button 
                                        Grid.Column="1"
                                        x:Name="ShowDecryptPasswordButton"
                                        Content="👁️"
                                        Style="{StaticResource SmallButton}"
                                        Click="ShowDecryptPassword_Click"
                                        VerticalAlignment="Center"
                                        Margin="8,0,0,0"/>
                                </Grid>
                            </StackPanel>

                            <!-- Recovery Phrase Input -->
                            <StackPanel x:Name="RecoveryPhraseDecryptPanel" Visibility="Collapsed">
                                <TextBlock 
                                    Text="Frase de Recuperación (12 palabras):" 
                                    FontSize="14"
                                    Foreground="{StaticResource OnSurfaceBrush}"
                                    Margin="0,0,0,8"/>
                                
                                <TextBox 
                                    x:Name="DecryptRecoveryPhraseInput"
                                    Style="{StaticResource RecoveryPhraseInput}"
                                    ToolTip="Ingrese las 12 palabras de la frase de recuperación separadas por espacios"
                                    TextChanged="DecryptRecoveryPhrase_TextChanged"/>
                                
                                <TextBlock 
                                    x:Name="RecoveryPhraseValidation"
                                    Text="Ingrese las 12 palabras separadas por espacios"
                                    Style="{StaticResource WarningText}"
                                    Margin="0,4,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Decrypt Drag & Drop Card -->
                    <Border Style="{StaticResource Card}">
                        <StackPanel>
                            <TextBlock 
                                Text="📂 Arrastrar Archivos para Desencriptar" 
                                Style="{StaticResource SectionTitle}"/>
                            
                            <Grid x:Name="DecryptDropZone" Height="120" Margin="0,8,0,0">
                                <Rectangle 
                                    Stroke="#FFEF4444" 
                                    StrokeThickness="2" 
                                    StrokeDashArray="8,4" 
                                    RadiusX="12" 
                                    RadiusY="12"
                                    Fill="Transparent"/>
                                
                                <StackPanel 
                                    HorizontalAlignment="Center" 
                                    VerticalAlignment="Center">
                                    <TextBlock 
                                        Text="🔓" 
                                        FontSize="32" 
                                        HorizontalAlignment="Center" 
                                        Foreground="#FFEF4444"
                                        Margin="0,0,0,8"/>
                                    <TextBlock 
                                        Text="Arrastra archivos .enc aquí para desencriptar" 
                                        FontSize="16" 
                                        FontWeight="SemiBold"
                                        HorizontalAlignment="Center" 
                                        Foreground="{StaticResource OnSurfaceBrush}"
                                        Margin="0,0,0,8"/>
                                    <TextBlock 
                                        Text="O haz clic en el botón de abajo" 
                                        FontSize="12" 
                                        HorizontalAlignment="Center" 
                                        Foreground="#FFEF4444" 
                                        Opacity="0.8"/>
                                </StackPanel>
                            </Grid>

                            <Button 
                                Content="🔓 Seleccionar Archivo .enc para Desencriptar"
                                Style="{StaticResource AccentButton}"
                                Click="DecryptFile_Click"
                                HorizontalAlignment="Center"
                                Margin="0,16,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Info Card -->
                <Border Style="{StaticResource Card}" Background="#FF1A2332" Margin="0,24,0,0">
                    <StackPanel>
                        <TextBlock 
                            Text="💡 Información" 
                            Style="{StaticResource SectionTitle}"
                            Foreground="#FF60A5FA"/>
                        
                        <StackPanel>
                            <TextBlock 
                                Text="🔐 Encriptación:"
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#FF60A5FA"
                                Margin="0,0,0,4"/>
                            <TextBlock 
                                Text="• Los archivos encriptados tendrán extensión .enc"
                                FontSize="13"
                                Foreground="#FFBFDBFE"
                                TextWrapping="Wrap"
                                Margin="8,0,0,4"/>
                            <TextBlock 
                                Text="• Se genera automáticamente una frase de recuperación de 12 palabras"
                                FontSize="13"
                                Foreground="#FFBFDBFE"
                                TextWrapping="Wrap"
                                Margin="8,0,0,4"/>
                            <TextBlock 
                                Text="• Usa contraseñas seguras para mejor protección"
                                FontSize="13"
                                Foreground="#FFBFDBFE"
                                TextWrapping="Wrap"
                                Margin="8,0,0,8"/>
                            
                            <TextBlock 
                                Text="🔓 Desencriptación:"
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#FF60A5FA"
                                Margin="0,0,0,4"/>
                            <TextBlock 
                                Text="• Puedes usar la contraseña original O la frase de recuperación"
                                FontSize="13"
                                Foreground="#FFBFDBFE"
                                TextWrapping="Wrap"
                                Margin="8,0,0,4"/>
                            <TextBlock 
                                Text="• La frase de recuperación es útil si olvidas la contraseña"
                                FontSize="13"
                                Foreground="#FFBFDBFE"
                                TextWrapping="Wrap"
                                Margin="8,0,0,4"/>
                            <TextBlock 
                                Text="• Arrastra archivos directamente a las zonas correspondientes"
                                FontSize="13"
                                Foreground="#FFBFDBFE"
                                TextWrapping="Wrap"
                                Margin="8,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>